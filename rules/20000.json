{"access":[{"pattern":"^(?:GET|HEAD)$","opts":{"nolog":true},"operator":"REGEX","description":"GET/HEAD request with a body","vars":[{"type":"METHOD"}],"id":20001,"action":"CHAIN"},{"pattern":"0","description":"GET/HEAD request with a body","op_negated":1,"operator":"EQUALS","opts":{"score":2},"id":20002,"vars":[{"parse":{"key":"specific","value":"content-length"},"type":"REQUEST_HEADERS"}],"action":"SCORE"},{"id":20003,"vars":[{"type":"METHOD"}],"action":"CHAIN","pattern":"POST","description":"POST request does not have a Content-Length Header","operator":"EQUALS","opts":{"nolog":true}},{"pattern":"content-length","description":"POST request does not have a Content-Length Header","op_negated":1,"operator":"CONTAINS","opts":{"score":2},"vars":[{"type":"REQUEST_HEADERS","parse":{"key":"keys"}}],"id":20004,"action":"SCORE"},{"operator":"EQUALS","description":"Identity should not be used in Content-Encoding, only in Accept-Encoding","opts":{"score":2,"transform":"lowercase"},"pattern":"identity","action":"SCORE","id":20005,"vars":[{"parse":{"value":"content-encoding","key":"specific"},"type":"REQUEST_HEADERS"}]},{"operator":"REGEX","description":"Expect header sent in non-HTTP/1.1 request","opts":{"nolog":true},"pattern":"100-continue","action":"CHAIN","vars":[{"parse":{"value":"expect","key":"specific"},"type":"REQUEST_HEADERS"}],"id":20006},{"description":"Expect header sent in non-HTTP/1.1 request","operator":"EQUALS","op_negated":1,"opts":{"score":2},"pattern":1.1,"action":"SCORE","vars":[{"type":"HTTP_VERSION"}],"id":20007},{"pattern":"pragma","opts":{"nolog":true},"operator":"CONTAINS","vars":[{"type":"REQUEST_HEADERS","parse":{"key":"keys"}}],"id":20008,"action":"CHAIN"},{"operator":"EQUALS","opts":{"transform":"lowercase","nolog":true},"pattern":"no-cache","action":"CHAIN","id":20009,"vars":[{"type":"REQUEST_HEADERS","parse":{"key":"specific","value":"pragma"}}]},{"opts":{"nolog":true},"op_negated":1,"operator":"CONTAINS","pattern":"cache-control","action":"CHAIN","id":20010,"vars":[{"type":"REQUEST_HEADERS","parse":{"key":"keys"}}]},{"pattern":"1.1","opts":{"score":2},"op_negated":1,"operator":"EQUALS","description":"HTTP/1.1 request sent with a Pragma:no-cache header, but no corresponding Cache-Control header","id":20011,"vars":[{"type":"HTTP_VERSION"}],"action":"SCORE"},{"vars":[{"parse":{"value":"range","key":"specific"},"type":"REQUEST_HEADERS"}],"id":20012,"action":"SCORE","pattern":"^bytes=0-","operator":"REGEX","description":"Request sent with abnormal Range header","opts":{"score":2}},{"pattern":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,","operator":"REGEX","description":"Excessive number of byte range fields within one request","opts":{"score":2},"vars":[{"type":"REQUEST_HEADERS","parse":{"key":"specific","value":"range"}}],"id":20013,"action":"SCORE"},{"action":"SCORE","id":20014,"vars":[{"parse":{"key":"specific","value":"request-range"},"type":"REQUEST_HEADERS"}],"opts":{"score":2},"operator":"REGEX","description":"Excessive number of byte range fields within one request","pattern":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,"},{"vars":[{"parse":{"value":"connection","key":"specific"},"type":"REQUEST_HEADERS"}],"id":20015,"pattern":"\\b(keep-alive|close),\\s?(keep-alive|close)\\b","description":"Duplicate/broken connection header","operator":"REGEX","action":"SCORE","opts":{"score":2}}],"header_filter":{},"body_filter":{}}
